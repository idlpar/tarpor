document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".add-to-wishlist").forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();const o=this.dataset.productId;n(o)})});function n(e){fetch("/wishlist/add",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({product_id:e})}).then(t=>{if(console.log("Wishlist add response status:",t.status),t.status===401)throw Swal.fire({icon:"warning",title:"Login Required",text:"You need to log in or register to add products to your wishlist.",showConfirmButton:!0,confirmButtonText:"Go to Login",allowOutsideClick:!1}).then(o=>{o.isConfirmed&&(window.location.href="/login")}),new Error("Unauthorized");return t.json()}).then(t=>{t.message&&(Swal.fire({icon:"success",title:"Success",text:t.message,showConfirmButton:!1,timer:1500}),i())}).catch(t=>console.error("Error:",t))}function i(){fetch("/wishlist/count").then(e=>e.json()).then(e=>{console.log("Wishlist count data:",e);const t=document.getElementById("wishlist-count");t&&(t.textContent=e.count)})}});
